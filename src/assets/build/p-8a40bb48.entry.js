import{r as e,c as t,h as a,g as s}from"./p-44118c4f.js";const i=class{constructor(a){e(this,a),this.dropItem=t(this,"dropItem",7),this.uploadFile=t(this,"uploadFile",7),this.dropFiles=[],this.$=window.$,this.listenerSubmit=()=>{const e=this.uploaderDraggableElement.querySelector("form");this.$(e).on("submit",(e=>{e.preventDefault()}))},this.listenerUploaderFileElement=()=>{this.uploaderDraggableElement.addEventListener("uploadFile",(e=>{this.uploadItem(e)}),!0)},this.uploadItem=e=>{const t=this.uploaderDraggableElement.querySelectorAll("mm-file-item");for(let a=0;a<t.length;a++)Number(t[a].getAttribute("data-ref"))===this.file.lastModified&&t[a].setValueUploader(e.detail.percentComplete)},this.getClassUploaderDraggable=()=>{let e="uploader-draggale";return 0!==this.dropFiles.length&&(e+=" none"),e},this.onDragover=e=>{e.stopPropagation(),e.preventDefault()},this.onDrop=e=>{e.stopPropagation(),e.preventDefault();const t=this.uploaderDraggableElement.querySelector(".uploader"),a=e.dataTransfer.files;this.updateInputFiles(a);for(let e=0;e<a.length;e++)this.createItem(a[e]),void 0!==this.urlServer&&(this.file=a[e],this.$(t).submit());this.emitDropItem(a)},this.emitDropItem=e=>{this.dropItem.emit({files:e})},this.createItem=e=>{const t=document.createElement("mm-file-item");t.addEventListener("deleteItem",(e=>{this.deleteItem(e)}),!1),t.setAttribute("data-ref",e.lastModified);const a=this.uploaderDraggableElement.querySelector(".uploader");t.nameFile=e.name,a.appendChild(t),this.dropFiles=[...this.dropFiles,e]},this.deleteItem=e=>{for(let t=0;t<this.dropFiles.length;t++)this.dropFiles[t].name===e.detail.name&&(this.dropFiles.splice(t,1),this.dropFiles=[...this.dropFiles],this.updateInputFiles(this.dropFiles))}}render(){return a("form",{enctype:"multipart/form-data",method:"post",action:this.urlServer,class:"uploader"},a("div",{class:this.getClassUploaderDraggable()},a("p",null,"Arrastra aquí para subir archivos"),a("p",{class:"grey"},"Los archivos que añadas se mostrarán en un listado en el que podrás ver el progreso de la subida")),a("input",{type:"file",multiple:!0,name:"files[]"}))}componentDidLoad(){console.log("mm-uploader-draggable - Este componente ha quedado obsoleto, utilizar en su lugar el componente mm-uploader"),this.$&&(this.sendFileServer(),this.listenerSubmit(),this.listenerUploaderFileElement(),this.uploaderDraggableElement.addEventListener("drop",(e=>{this.onDrop(e)}),!0),this.uploaderDraggableElement.addEventListener("dragover",(e=>{this.onDragover(e)}),!1))}updateInputFiles(e){const t=this.uploaderDraggableElement.querySelector("input[type=file]");e.length<1?t.value="":t.files=e}sendFileServer(){const e=this.uploaderDraggableElement.querySelector(".uploader");this.$(e).ajaxForm({type:"post",uploadProgress:(e,t,a,s)=>{this.uploadFile.emit({event:e,position:t,total:a,percentComplete:s})},complete:()=>{this.uploadFile.emit({percentComplete:100})}})}get uploaderDraggableElement(){return s(this)}};i.style=':root{--grey_050:#fcfcfa;--grey_100:#f9f9f9;--grey_200:#f2f2f2;--grey_300:#e9ecf0;--grey_400:#dfe1e2;--grey_500:#ccc;--grey_600:#a0aab5;--grey_700:#89858e;--grey_750:#73757b;--grey_800:#61616a;--grey_900:#55494c;--grey_950:#2a2425;--brand_accent_100:#f2fafd;--brand_accent_200:#e3f2fd;--brand_accent_300:#c1e3fc;--brand_accent_500:#00a4e3;--brand_accent_750:#0068a3;--brand_accent_800:#004a93;--primary_500:#3269b3;--primary_900:#283c57;--full_white:#fff;--full_black:#000;--action_300:#e56aa8;--action_500:#c9337d;--action_800:#750e70;--action_900:#440d7f;--status_critical_100:#fcded4;--status_critical_500:#d62c42;--status_critical_800:#660837;--status_warning_100:#fff2d6;--status_warning_500:#ffae33;--status_warning_800:#66380f;--status_success_100:#e6f8e0;--status_success_500:#42804a;--status_success_800:#0c3d25;--status_info_100:#e5fafe;--status_info_500:#7cc3f4;--status_info_800:#004a93;--client_platinium:#625951;--client_gold_500:#e0af31;--client_gold_800:#66380f;--client_basic:#3269b3;--client_hogar:#ffffff;--enviroment_dev:#f118a7;--enviroment_acp:#68d568;--enviroment_prf:#7cc3f4;--enviroment_uat:#ffd400;--segmentoa_500:#7aebb7;--segmentoa_800:#006060;--segmentob_500:#9ad7ff;--segmentob_800:#3a539b;--segmentoc_500:#e38b63;--segmentoc_800:#600000;--segmentod_500:#d999f2;--segmentod_800:#561b8d;--cca_500:#f2bf2e;--cca_800:#ff6e33}mm-uploader-draggable{min-height:200px;border:3px dotted var(--grey_500, #ccc);display:block}mm-uploader-draggable input[type=file]{opacity:0;visibility:hidden}mm-uploader-draggable .uploader-draggale{width:100%;min-height:200px;display:flex;flex-direction:column;justify-content:center;padding:15px;box-sizing:border-box}mm-uploader-draggable .uploader-draggale>p{padding:0 50px;text-align:center}mm-uploader-draggable .uploader-draggale>p:first-of-type{font-size:16px;height:20px;color:var(--grey_600, #a0aab5);font-family:"OpenSans-SemiBold"}mm-uploader-draggable .none{display:none}';export{i as mm_uploader_draggable}